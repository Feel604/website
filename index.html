<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Pentest Practice — Vulnerable Static Site</title>
  <style>
    body{font-family:system-ui,Segoe UI,Roboto,Arial;margin:24px;line-height:1.4}
    header{display:flex;gap:16px;align-items:center}
    main{margin-top:18px}
    nav a{margin-right:12px}
    .box{border:1px solid #ddd;padding:12px;border-radius:8px;margin:12px 0}
    input,button,textarea{font-size:14px;padding:8px;margin:6px 0}
    .badge{background:#eee;padding:4px 8px;border-radius:6px;font-size:12px}
    pre{background:#f7f7f7;padding:12px;border-radius:6px;overflow:auto}
  </style>
</head>
<body>
  <header>
    <h1>Pentest Practice — Vulnerable Static Site</h1>
    <div class="badge">For learning only — do not host sensitive data</div>
  </header>

  <p>This single-file static site intentionally includes insecure client-side patterns you can use to practice DOM/Reflected XSS, insecure storage, insecure eval, and weak client-side auth flows. <strong>Do not</strong> publish this on a production server with any sensitive data.</p>

  <nav>
    <a href="#search">Search (DOM XSS)</a>
    <a href="#reflect">Reflected (query param) XSS</a>
    <a href="#login">Login (insecure client auth)</a>
    <a href="#eval">Insecure Eval</a>
    <a href="#notes">Notes</a>
  </nav>

  <main>
    <section id="search" class="box">
      <h2>Search (DOM XSS)</h2>
      <p>Type something and click <em>Search</em>. The app intentionally inserts user input as HTML into the page.</p>
      <label>Query: <input id="search-q" placeholder="try &lt;img src=x onerror=alert(1)>&quot;"></label>
      <button id="search-btn">Search</button>
      <div id="search-results" style="margin-top:10px"></div>
    </section>

    <section id="reflect" class="box">
      <h2>Reflected XSS via URL param</h2>
      <p>Pass a <code>?q=...</code> parameter in the URL and the page will reflect it unsafely into the DOM when you click <em>Reflect now</em>. This simulates a naive server that reflects query parameters (but implemented client-side here for convenience).</p>
      <button id="reflect-btn">Reflect now</button>
      <div id="reflect-output" style="margin-top:10px"></div>
    </section>

    <section id="login" class="box">
      <h2>Insecure Login (client-side auth)</h2>
      <p>This form checks credentials purely in the browser and stores a plaintext "session token" in <code>localStorage</code>. This simulates broken auth flows where secrets are stored client-side.</p>
      <div>
        <label>Username: <input id="u-username" value="admin"></label><br>
        <label>Password: <input id="u-password" type="password" value="password"></label><br>
        <button id="login-btn">Login</button>
        <button id="logout-btn">Logout</button>
      </div>
      <div id="auth-status" style="margin-top:10px"></div>

      <div id="admin-panel" style="display:none;margin-top:12px;padding:8px;background:#fff7f0;border:1px solid #ffd1a8;border-radius:6px">
        <strong>Admin panel</strong>
        <p>Secret data: <code id="secret-data">[REDACTED]</code></p>
      </div>
    </section>

    <section id="eval" class="box">
      <h2>Insecure Eval</h2>
      <p>This form demonstrates an obviously insecure use of <code>eval()</code> on user input. Only for controlled lab use.</p>
      <textarea id="eval-input" rows="4" cols="60" placeholder="e.g. 2+2 or alert('hello')"></textarea><br>
      <button id="run-eval">Run eval()</button>
      <div id="eval-output" style="margin-top:10px"></div>
    </section>

    <section id="notes" class="box">
      <h2>Notes, safety & cleanup</h2>
      <ul>
        <li>Only run this on a local machine or inside an isolated environment.</li>
        <li>Do not put real credentials, API keys, or personal data into this site.</li>
        <li>If publishing to GitHub Pages, be prepared to take it down quickly and consider using a throwaway account or repository.</li>
        <li>This site intentionally contains insecure code for learning — do not use it as a template for real products.</li>
      </ul>
    </section>
  </main>

  <footer style="margin-top:18px;color:#666;font-size:13px">Created for pentest practice — exercise caution. (No exploit guidance provided.)</footer>

  <script>
    // ---------- Search (DOM XSS) ----------
    document.getElementById('search-btn').addEventListener('click', ()=>{
      const q = document.getElementById('search-q').value || '';
      // intentionally unsafe insertion
      const out = document.getElementById('search-results');
      out.insertAdjacentHTML('beforeend', '<div>Search results for: ' + q + '</div>');
    });

    // ---------- Reflected (query param) XSS ----------
    function reflectQuery(){
      const params = new URLSearchParams(location.search);
      const q = params.get('q');
      const out = document.getElementById('reflect-output');
      if(q){
        // intentionally naive reflection
        out.innerHTML = 'Reflected: ' + q;
      } else {
        out.textContent = 'No ?q= parameter in the URL. Try adding ?q=<script>alert(1)</script>'; 
      }
    }
    document.getElementById('reflect-btn').addEventListener('click', reflectQuery);

    // reflect on load if param exists
    if(new URLSearchParams(location.search).has('q')) reflectQuery();

    // ---------- Insecure login flow ----------
    const USERS = [{user:'admin', pass:'password', secret:'The launch code is 1234'},{user:'guest', pass:'guest', secret:'guest note'}];

    function updateAuthUI(){
      const token = localStorage.getItem('pptoken');
      const status = document.getElementById('auth-status');
      if(token){
        status.innerHTML = 'Logged in. Token stored in localStorage: <code>'+token+'</code>';
        document.getElementById('admin-panel').style.display = 'block';
        // token here is just username for demo
        const user = USERS.find(u=>u.user===token);
        document.getElementById('secret-data').textContent = user ? user.secret : '[no secret]';
      } else {
        status.textContent = 'Not logged in.';
        document.getElementById('admin-panel').style.display = 'none';
      }
    }
    document.getElementById('login-btn').addEventListener('click', ()=>{
      const user = document.getElementById('u-username').value;
      const pass = document.getElementById('u-password').value;
      const found = USERS.find(u=>u.user===user && u.pass===pass);
      if(found){
        // insecure: store username as "token" in localStorage
        localStorage.setItem('pptoken', found.user);
        updateAuthUI();
        alert('Logged in as ' + found.user);
      } else {
        alert('Bad credentials');
      }
    });
    document.getElementById('logout-btn').addEventListener('click', ()=>{
      localStorage.removeItem('pptoken');
      updateAuthUI();
      alert('Logged out');
    });
    updateAuthUI();

    // ---------- Insecure eval ----------
    document.getElementById('run-eval').addEventListener('click', ()=>{
      const src = document.getElementById('eval-input').value || '';
      const out = document.getElementById('eval-output');
      try{
        // obviously insecure by design
        const result = eval(src);
        out.textContent = 'Result: ' + String(result);
      }catch(e){
        out.textContent = 'Error: ' + e.message;
      }
    });

    // ---------- Extra: simple client-side router for anchor links ----------
    (function(){
      function scrollToHash(){
        if(location.hash){
          const el = document.querySelector(location.hash);
          if(el) el.scrollIntoView();
        }
      }
      window.addEventListener('hashchange', scrollToHash);
      setTimeout(scrollToHash,100);
    })();
  </script>
</body>
</html>
